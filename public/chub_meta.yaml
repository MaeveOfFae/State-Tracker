name: RP State Tracker
description: Track in-RP date/time/place/mood/weather and optionally inject it into the prompt.
tags:
  - roleplay
  - state
position: RIGHT

config_schema:
  title: RP State Tracker
  description: Settings for how RP state is shown and whether it is added to the prompt.
  type: object
  properties:
    include_in_prompt:
      type: boolean
      default: false
    include_in_system_message:
      type: boolean
      default: false
    prompt_block_label:
      type: string
      default: RP_STATE
    max_note_chars:
      type: integer
      default: 280
    auto_extract_before_prompt:
      type: boolean
      default: false
    only_show_on_change:
      type: boolean
      default: true
    auto_extract_after_response:
      type: boolean
      default: true
    diagnostics:
      type: boolean
      default: false
    extraction_strategy:
      type: string
      enum:
        - heuristic
        - llm
      default: heuristic
    extraction_llm_endpoint:
      type: string
      default: ""
    extraction_max_runtime_ms:
      type: integer
      default: 1500
    time_granularity:
      type: string
      enum:
        - date
        - datetime
      default: date

    # Optional JSON Schemas for stage state shapes (best-effort; refs minimized for compatibility)
    init_state_schema:
      title: InitState
      description: Initialization state (unused)
      type: 'null'

    message_state_schema:
      title: MessageState
      type: object
      properties:
        snapshot:
          title: RPState
          type: object
          properties:
            inRoleplayDateTime: { type: string }
            place: { type: string }
            mood: { type: string }
            weather: { type: string }
            sceneNotes: { type: string }
          required: [inRoleplayDateTime, place, mood, weather, sceneNotes]
      required: [snapshot]

    chat_state_schema:
      title: ChatState
      type: object
      properties:
        current:
          title: RPState
          type: object
          properties:
            inRoleplayDateTime: { type: string }
            place: { type: string }
            mood: { type: string }
            weather: { type: string }
            sceneNotes: { type: string }
          required: [inRoleplayDateTime, place, mood, weather, sceneNotes]
      required: [current]

github_path: 'https://github.com/MaeveOfFae/State-Tracker'


extension_id: 'state-tracker-d41cf3c559f1'

